<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Drapie, pelpa y ratije</title>
  <style>
    body {
      background: linear-gradient(120deg, #f6d365, #fda085);
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    .container {
      background: white;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      width: 90%;
      max-width: 400px;
      padding: 20px;
      text-align: center;
      position: relative;
    }

    .title {
      font-size: 1.5em;
      margin-bottom: 10px;
      color: #333;
    }

    .nickname {
      padding: 10px;
      margin-bottom: 15px;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 1em;
    }

    .emoji-list {
      max-height: 200px;
      overflow-y: scroll;
      display: grid;
      grid-template-columns: repeat(auto-fill, 50px);
      gap: 10px;
      justify-content: center;
      align-items: center;
    }

    .emoji {
      font-size: 1.8em;
      cursor: pointer;
      user-select: none;
      transition: transform 0.8s ease, top 0.8s ease, left 0.8s ease;
      position: relative;
    }

    .emoji:hover {
      transform: scale(1.2);
      transition: 0.2s;
    }

    .confirm {
      margin-top: 15px;
      padding: 10px 20px;
      background: #fda085;
      border: none;
      color: white;
      border-radius: 5px;
      font-size: 1em;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .confirm:hover {
      background: #f6d365;
    }

    .confirm:disabled {
      background-color: grey;
    }

    .selected-emoji {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(3);
      font-size: 3em;
      transition: all 0.8s ease;
    }

    .fade-out {
      opacity: 0 !important;
      transition: opacity 1s ease;
    }

    .fade-in {
      opacity: 1 !important;
      transition: opacity 1s ease;
    }

    #selected-nickname {
      opacity: 0;
      color: white;
      font-size: 2em;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="title">Selecciona tu Emotar</div>
    <div class="emoji-list" id="emojiList">
      <!-- Emojis se cargarán aquí -->
    </div>
    <input type="text" id="nickname" class="nickname" placeholder="Apodo...">
    <button class="confirm" id="confirmButton" disabled>Confirmar</button>
  </div>
  <div id="selected-nickname"></div>

  <script>
    const emojiList = [
      "🐵", "🐶", "🐺", "🦊", "🦝", "🐱", "🦁", "🐯",
      "🐮", "🐷", "🐭", "🐹", "🐰", "🐻", "🐨", "🐼" ];

    const emojiContainer = document.getElementById('emojiList');
    const confirmButton = document.getElementById('confirmButton');

    let selectedEmoji = null;

    function renderEmojis(filter = '') {
      emojiContainer.innerHTML = '';
      emojiList
        .filter(emoji => emoji.includes(filter))
        .forEach(emoji => {
          const emojiDiv = document.createElement('div');
          emojiDiv.className = 'emoji';
          emojiDiv.textContent = emoji;
          emojiDiv.id = emoji
          emojiDiv.onclick = () => selectEmoji(emoji, emojiDiv);
          emojiContainer.appendChild(emojiDiv);
        });
    }

    function selectEmoji(emoji, element) {
      document.querySelectorAll('.emoji').forEach(el => el.style.border = 'none');
      element.style.border = '2px solid #fda085';
      selectedEmoji = emoji;
      confirmButton.disabled = false;
    }

    function confirmSelectEmoji(emoji) {
      const container = document.querySelector('.container');
      const element = document.getElementById(emoji)
      const rect = element.getBoundingClientRect();
      const emojiClone = element.cloneNode(true);

      emojiClone.classList.add('selected-emoji');
      emojiClone.style.top = `${rect.top + window.scrollY}px`;
      emojiClone.style.left = `${rect.left + window.scrollX}px`;
      emojiClone.style.position = 'absolute';
      emojiClone.style.border = 'none';

      document.body.appendChild(emojiClone);

      const viewNicknameElement =  document.getElementById("selected-nickname")
      new Promise((resolve) => {
        setTimeout(() => {
          emojiClone.style.top = '50%';
          emojiClone.style.left = '50%';
          emojiClone.style.transform = 'translate(-50%, -50%) scale(3)';

          const nicknameElement = document.getElementById('nickname').value
          const nickname = nicknameElement || "Mistery"
          viewNicknameElement.classList.add('fade-in');
          viewNicknameElement.innerText = nickname
          resolve(true)
        }, 250)
      }).then(() => {
        setTimeout(() => {
          emojiClone.classList.add('fade-out');
          viewNicknameElement.classList.remove('fade-in');
          viewNicknameElement.classList.add('fade-out');
        }, 1000)
      })

      container.classList.add('fade-out');

      /*setTimeout(() => {
        container.style.display = 'none';
      }, 500);*/
    }


    /*function confirmSelectEmoji(emoji) {
      const container = document.querySelector('.container');

      const selectedEmoji = document.createElement('div');
      selectedEmoji.className = 'selected-emoji';
      selectedEmoji.textContent = emoji;


      document.body.appendChild(selectedEmoji);
      container.classList.add('fade-out');

      setTimeout(() => {
        container.style.display = 'none';
      }, 500);
    }*/


    confirmButton.addEventListener('click', () => {
      if (selectedEmoji) {
        confirmSelectEmoji(selectedEmoji)
      }
    });

    renderEmojis();
  </script>
</body>
</html>
